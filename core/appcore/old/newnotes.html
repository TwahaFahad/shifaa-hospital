
{% extends 'base.html' %}


{% block content %} 



<div class="grid grid-cols-1 gap-4 sm:gap-5 lg:gap-6 mt-5">

    
    <!-- Users Table -->
    <div>

    <div class="flex items-center justify-between">
        <div x-data="{showModal:false}">
            <button
            @click="showModal = true"
            class="btn bg-primary font-medium text-white hover:bg-primary focus:bg-primary active:bg-primary dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
            >
            Add patient
            </button>
            <template x-teleport="#x-teleport-target">
              <div
                class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5"
                x-show="showModal"
                role="dialog"
                @keydown.window.escape="showModal = false"
              >
                <div
                  class="absolute inset-0 bg-slate-900/60 transition-opacity duration-300"
                  @click="showModal = false"
                  x-show="showModal"
                  x-transition:enter="ease-out"
                  x-transition:enter-start="opacity-0"
                  x-transition:enter-end="opacity-100"
                  x-transition:leave="ease-in"
                  x-transition:leave-start="opacity-100"
                  x-transition:leave-end="opacity-0"
                ></div>
                <div
                  class="relative flex w-full max-w-lg origin-top flex-col overflow-hidden rounded-lg bg-white transition-all duration-300 dark:bg-navy-700"
                  x-show="showModal"
                  x-transition:enter="easy-out"
                  x-transition:enter-start="opacity-0 scale-95"
                  x-transition:enter-end="opacity-100 scale-100"
                  x-transition:leave="easy-in"
                  x-transition:leave-start="opacity-100 scale-100"
                  x-transition:leave-end="opacity-0 scale-95"
                >
                  <div
                    class="flex justify-between rounded-t-lg bg-slate-200 px-4 py-3 dark:bg-navy-800 sm:px-5"
                  >
                    <h3
                      class="text-base font-medium text-slate-700 dark:text-navy-100"
                    >
                      Add Patient
                    </h3>
                    <button
                      @click="showModal = !showModal"
                      class="btn -mr-1.5 h-7 w-7 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="h-4.5 w-4.5"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M6 18L18 6M6 6l12 12"
                        />
                      </svg>
                    </button>
                  </div>
                  
                  <div class="flex flex-col overflow-y-auto px-4 py-4 sm:px-5" >
                    <div class="mt-4 space-y-4">
                        <form id="add-patient-form">

                        <label class="block">
                            <span>First Name:</span>
                            <input id="first_name"
                            class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent"
                            placeholder="First Name"
                            type="text"
                            required
                            />
                        </label>

                        <label class="block">
                            <span>Last Name:</span>
                            <input id="last_name"
                            class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent"
                            placeholder="Last Name"
                            type="text"
                            required
                            />
                        </label>

                        <label class="block">
                            <span>Date of Birth:</span>
                            <input id="dob"
                            class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent"
                            type="date"
                            required
                            />
                        </label>

                        <label class="block">
                            <span>Select Gender</span>
                            <select id="gender" required 
                            class="form-select mt-1.5 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:bg-navy-700 dark:hover:border-navy-400 dark:focus:border-accent"
                            >
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            </select>
                        </label>

                        <label class="block">
                            <span>Contact Info:</span>
                            <input id="contact_info"
                            class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent"
                            placeholder="Contact Info"
                            type="text"
                            required
                            />
                        </label>

                         <div class="space-x-2 text-right">
                            <button
                            class="btn min-w-[7rem] rounded-full border border-slate-300 font-medium text-slate-800 hover:bg-slate-150 focus:bg-slate-150 active:bg-slate-150/80 dark:border-navy-450 dark:text-navy-50 dark:hover:bg-navy-500 dark:focus:bg-navy-500 dark:active:bg-navy-500/90"
                            >
                            Cancel
                            </button>
                            <button type="submit" 
                            class="btn min-w-[7rem] rounded-full bg-primary font-medium text-white hover:bg-primary-focus focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                            >
                           Submit
                        </button>
                        </div>
                        </form> 

                    </div>
                  </div>
                
                </div>
              </div>
            </template>
          </div>

      </div>

      <div class="flex items-center justify-between">
        <h2
          class="line-clamp-1 text-base font-medium tracking-wide text-slate-700 dark:text-navy-100"
        >
          Patients
        </h2>
        <div class="flex">
          <div class="flex items-center" x-data="{isInputActive:false}">
            <label class="block">
              <input
                x-effect="isInputActive === true && $nextTick(() => { $el.focus()});"
                :class="isInputActive ? 'w-32 lg:w-48' : 'w-0'"
                class="form-input bg-transparent px-1 text-right transition-all duration-100 placeholder:text-slate-500 dark:placeholder:text-navy-200"
                placeholder="Search here..."
                type="text"
              />
            </label>
            <button
              @click="isInputActive = !isInputActive"
              class="btn h-8 w-8 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4.5 w-4.5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                />
              </svg>
            </button>
          </div>

        </div>
      </div>

      <div class="card mt-3">

        <div class="is-scrollbar-hidden min-w-full overflow-x-auto">
            <table class="is-hoverable w-full text-left">
                <thead>
                <tr>
                    <th
                    class="whitespace-nowrap rounded-tl-lg bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5"
                    >
                    Name
                    </th>
                    <th
                    class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5"
                    >
                    DOB
                    </th>
                    <th
                    class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5"
                    >
                    Gender
                    </th>
                    <th
                    class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5"
                    >
                    Diagnosis
                    </th>
                    <th
                    class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5"
                    >
                    Referral
                    </th>
                    <th
                    class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5"
                    >
                    Diagnosis
                    </th>
                    <th
                    class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5"
                    >
                    Hostory
                    </th>
                    <th
                    class="whitespace-nowrap rounded-tr-lg bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5"
                    >
                    Action
                    </th>
                </tr>
                </thead>
                <tbody id="patient-list">

                   
                </tbody>
            </table>
            </div>

        
        <div class="flex flex-col justify-between space-y-4 px-4 py-4 sm:flex-row sm:items-center sm:space-y-0 sm:px-5">
            <div class="flex items-center space-x-2 text-xs+">
                <span>Show</span>
                <label class="block">
                <select
                    class="form-select rounded-full border border-slate-300 bg-white px-2 py-1 pr-6 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:bg-navy-700 dark:hover:border-navy-400 dark:focus:border-accent"
                >
                    <option>10</option>
                    <option>30</option>
                    <option>50</option>
                </select>
                </label>
                <span>entries</span>
            </div>

            <ol class="pagination">
                <li class="rounded-l-lg bg-slate-150 dark:bg-navy-500">
                <a
                    href="#"
                    class="flex h-8 w-8 items-center justify-center rounded-lg text-slate-500 transition-colors hover:bg-slate-300 focus:bg-slate-300 active:bg-slate-300/80 dark:text-navy-200 dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90"
                >
                    <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    stroke-width="2"
                    >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M15 19l-7-7 7-7"
                    />
                    </svg>
                </a>
                </li>
                <li class="bg-slate-150 dark:bg-navy-500">
                <a
                    href="#"
                    class="flex h-8 min-w-[2rem] items-center justify-center rounded-lg px-3 leading-tight transition-colors hover:bg-slate-300 focus:bg-slate-300 active:bg-slate-300/80 dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90"
                    >1</a
                >
                </li>
                <li class="bg-slate-150 dark:bg-navy-500">
                <a
                    href="#"
                    class="flex h-8 min-w-[2rem] items-center justify-center rounded-lg bg-primary px-3 leading-tight text-white transition-colors hover:bg-primary-focus focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                    >2</a
                >
                </li>
                <li class="bg-slate-150 dark:bg-navy-500">
                <a
                    href="#"
                    class="flex h-8 min-w-[2rem] items-center justify-center rounded-lg px-3 leading-tight transition-colors hover:bg-slate-300 focus:bg-slate-300 active:bg-slate-300/80 dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90"
                    >3</a
                >
                </li>
                <li class="bg-slate-150 dark:bg-navy-500">
                <a
                    href="#"
                    class="flex h-8 min-w-[2rem] items-center justify-center rounded-lg px-3 leading-tight transition-colors hover:bg-slate-300 focus:bg-slate-300 active:bg-slate-300/80 dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90"
                    >4</a
                >
                </li>
                <li class="bg-slate-150 dark:bg-navy-500">
                <a
                    href="#"
                    class="flex h-8 min-w-[2rem] items-center justify-center rounded-lg px-3 leading-tight transition-colors hover:bg-slate-300 focus:bg-slate-300 active:bg-slate-300/80 dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90"
                    >5</a
                >
                </li>
                <li class="rounded-r-lg bg-slate-150 dark:bg-navy-500">
                <a
                    href="#"
                    class="flex h-8 w-8 items-center justify-center rounded-lg text-slate-500 transition-colors hover:bg-slate-300 focus:bg-slate-300 active:bg-slate-300/80 dark:text-navy-200 dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90"
                >
                    <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 5l7 7-7 7"
                    />
                    </svg>
                </a>
                </li>
            </ol>

            <div class="text-xs+">1 - 10 of 10 entries</div>
            </div>
      </div>


    </div>



</div> 






    <!-- JavaScript for AJAX requests -->
    <script>

        $(document).ready(function() {
            loadPatients();
        });


        // Add new patient
        $('#add-patient-form').submit(function(event) {
            event.preventDefault(); // Prevent the form from submitting normally

            // Collect patient data
            const patientData = {
                first_name: $('#first_name').val(),
                last_name: $('#last_name').val(),
                dob: $('#dob').val(),
                gender: $('#gender').val(),
                contact_info: $('#contact_info').val()
            };

            // AJAX request to add a new patient
            $.ajax({
                url: '/shifaa/patients/add/',  // Adjust this URL if needed based on your API endpoint
                type: 'POST',
                data: patientData,
                success: function(response) {
                    alert('Patient added successfully');
                    loadPatients(); // Reload the patient list
                },
                error: function(error) {
                    alert('Error adding patient');
                }
            });
        });

        // Load all patients
        function loadPatients() {
            $.ajax({
                url: '/shifaa/patients/',
                type: 'GET',
                success: function(response) {
                    let patientHtml = '';
                    response.patients.forEach(function(patient) {
                        patientHtml += `
                            <tr class="border-y border-transparent border-b-slate-200 dark:border-b-navy-500">
                                <td class="whitespace-nowrap px-3 py-3 font-medium text-slate-700 dark:text-navy-100 lg:px-5">${patient.first_name} ${patient.last_name}</td>
                                <td class="whitespace-nowrap px-4 py-3 sm:px-5">${patient.dob}</td>
                                <td class="whitespace-nowrap px-4 py-3 sm:px-5">${patient.gender}</td>
                                
                                <td class="whitespace-nowrap px-4 py-3 sm:px-5" >

                                    <button
                                    class="btn rounded-full bg-warning font-medium text-white hover:bg-warning focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                                >
                                    Diagnose
                                </button>
                                </td>
                                <td class="whitespace-nowrap px-4 py-3 sm:px-5">

                                    <button
                                    class="btn rounded-full bg-warning font-medium text-white hover:bg-warning focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                                >
                                    Refer
                                </button>
                                </td>
                                <td class="whitespace-nowrap px-4 py-3 sm:px-5">

                                    <button
                                    class="btn rounded-full bg-primary font-medium text-white hover:bg-primary focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                                >
                                    Diagnostics
                                </button>
                                </td>
                                <td class="whitespace-nowrap px-4 py-3 sm:px-5">

                                    <button
                                    class="btn rounded-full bg-primary font-medium text-white hover:bg-primary focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                                >
                                    History
                                </button>
                                </td>
                                <td class="whitespace-nowrap px-4 py-3 sm:px-5">
                                    <div class="inline-flex" >
                                    


                                        <button class="btn h-9 w-9 p-0 font-medium text-primary hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M11 5h2m0 0l7 7-2 2-7-7m0 0V5M5 21l-1-4 4 1 11-11-4-4-11 11z"
                                                />
                                            </svg>
                                        </button>

                                        <button class="btn h-9 w-9 p-0 font-medium text-error hover:bg-error/20 focus:bg-error/20 active:bg-error/25">
                                            <svg  xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                                            />
                                            </svg>
                                            </button>

                                    </div>
                                </td>
                                </tr>
                            `;
                    });
                    $('#patient-list').html(patientHtml);
                },
                error: function(error) {
                    alert('Error loading patients');
                }
            });
        }

       

    </script>


{% endblock content %}


